{% extends 'Authentication/base.html' %}


{% block content %}


<ul class="nav nav-pills nav-fill">
  <li class="nav-item">
    <a class="nav-link active">Zalogowany jako: {{ user.username }}</a>
  </li>
  <li class="nav-item dropdown">
    <a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">Moje rodziny</a>
    <div class="dropdown-menu">
      <a class="dropdown-item" href="{% url 'myfamilies'%}">Przeglądaj rodziny</a>
      <div class="dropdown-divider"></div>
      <a class="dropdown-item" href="{% url 'createfamily'%}">Stwórz rodzinę</a>
      <a class="dropdown-item" href="{% url 'joinfamily'%}">Dołącz do rodziny</a>
    </div>
  </li>
  <li class="nav-item dropdown">
    <a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">Wydarzenia</a>
    <div class="dropdown-menu">
      <a class="dropdown-item" href="{% url 'myevents'%}">Przeglądaj moje wydarzenia</a>
      <div class="dropdown-divider"></div>
      <a class="dropdown-item" href="{% url 'addevent'%}">Dodaj wydarzenie</a>
    </div>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="{% url 'photos'%}">Zdjęcia</a>
  </li>
</ul>


{% if not my_families%}
<h2>Czas dołączyć do jakiejś rodziny</h2> <br>
<h4>Stwórz jako pierwszy swoją rodzię lub poproś osobę która zaprosiła Cię do Familiara o ID rodziny do której chciałbyś dołączyć</h4><br><br>
    <a href="{% url 'createfamily'%}" class="btn btn-primary btn-block">Stwórz rodzinę</a><br>
    <a href="{% url 'joinfamily'%}" class="btn btn-primary btn-block">Dołącz do istniejące rodziny</a><br>
{% else %}


<!--EVENTS-->

<h3>Nadchodzące wydarzenia:</h3><br>

{% for event in events_in_my_families %}
<div>
    <h4>Autor: {{ event.author }}</h4>
    <h3> {{ event.occasion }}</h3>
    <p>{{ event.desc }}</p>
    <h4>Data: {{ event.day }}.{{ event.month }}</h4>
</div><br><br>
{% endfor %}

<!--POST-->
<dvi>
<!--    CREATE POST-->
    <div>
        <form method="POST">
            {% csrf_token %}
           <label for="send_post">Send post visible to all member of your families!</label><br>
            <input type="hidden" name="form_type" value="post">
           <textarea name='send_post' id='send_post' rows="3" cols="50"></textarea><br>
           <button type="submit">Post!</button>
        </form>
    </div>

<!--    VIEW POSTS-->
    <div>
        {% if posts_in_my_families %}
            {% for post in posts_in_my_families %}
                <div>
                    <h3>{{ post.author }}</h3>
                    <p>{{ post.text }}</p>
                    <h6>{{ post.date }}</h6>
<!--                            delete post-->
                            <form method="POST">
                                {% csrf_token %}
                                <input type="hidden" name="form_type" value="delete">
                               <input name='post_to_delete' value="{{ post.pk }}" type=hidden >
                               <button type="submit">Delete!</button>
                            </form>
                </div>

            {% endfor %}
        {% endif %}
    </div>

<br>
<br>
<!--    PHOTOS-->
{% if photos_in_my_families %}
<div id="carouselExampleControls" class="carousel slide" data-ride="carousel" >
  <div class="carousel-inner">
    <div class="carousel-item active" style="height: 30vh;width:auto;">
      <h3 style="position: 20px;">Galeria</h3>
    </div>
   {% for photo in photos_in_my_families %}
    <div class="carousel-item" >
        <img src="{{ photo.photo.url }}" class="d-block w-100 img-fluid" alt="Image: {{ photo.title }}" style="height: 500px;width:auto;">
        <div class="carousel-caption d-none d-md-block">
        <h5>{{ photo.author }}: {{ photo.title }}</h5>
        <p>{{ photo.desc }}}}</p>
      </div>
    </div>
   {% endfor %}
  </div>
  <a class="carousel-control-prev" href="#carouselExampleControls" role="button" data-slide="prev">
    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
    <span class="sr-only">Previous</span>
  </a>
  <a class="carousel-control-next" href="#carouselExampleControls" role="button" data-slide="next">
    <span class="carousel-control-next-icon" aria-hidden="true"></span>
    <span class="sr-only">Next</span>
  </a>
</div>

{% endif %}


{% endif %}
<br>
<br>
<form action="{% url 'logoutuser' %}" method="POST">
    {% csrf_token %}
    <button type="submit" class="btn btn-primary btn-block">Logout</button>
</form>

{% endblock %}